<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Registro de Silo {{ numero_qr }}</title>
</head>
<body>
  <h2>Registro de Silo: {{ numero_qr }}</h2>

  <label>Cereal:</label>
  <select id="cereal">
    <option>Ma√≠z</option>
    <option>Soja</option>
    <option>Trigo</option>
    <option>Girasol</option>
  </select>

  <label>Metros lineales:</label>
  <input type="number" id="metros">

  <label>Notas:</label>
  <input type="text" id="notas">

  <button onclick="enviar()">Guardar datos</button>

  <script>
    function enviar() {
      navigator.geolocation.getCurrentPosition((pos) => {
        const data = {
          numero_qr: "{{ numero_qr }}",
          cereal: document.getElementById("cereal").value,
          metros: parseInt(document.getElementById("metros").value),
          notas: document.getElementById("notas").value,
          lat: pos.coords.latitude,
          lon: pos.coords.longitude
        };
        fetch("/api/save", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        }).then(r => r.json()).then(() => alert("Datos guardados correctamente."));
      }, (err) => alert("Error obteniendo GPS: " + err.message));
    }
  </script>
</body>
</html>
