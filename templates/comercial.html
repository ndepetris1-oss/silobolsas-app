<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Comercial</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial;
  background:#eef5ee;
  margin:0;
}
header{
  background:#2e7d32;
  color:white;
  padding:14px;
  text-align:center;
  font-size:20px;
}
.container{
  width:90%;
  margin:20px auto;
  background:white;
  padding:20px;
  border-radius:12px;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  border-bottom:1px solid #c8e6c9;
  padding:10px;
  text-align:center;
}
th{
  background:#e8f5e9;
}
button{
  background:#43a047;
  color:white;
  border:none;
  border-radius:6px;
  padding:6px 10px;
  cursor:pointer;
}
button:hover{background:#2e7d32}
input{
  width:100px;
  padding:4px;
  text-align:right;
}
</style>
</head>

<body>

<header>üí∞ Comercial ‚Äì Precios manuales</header>

<div class="container">

<button onclick="location.href='/panel'">‚Üê Volver al panel</button>

<table style="margin-top:15px">
  <tr>
    <th>Cereal</th>
    <th>Pizarra (ARS/TN)</th>
    <th>D√≥lar</th>
    <th>√öltima act.</th>
    <th>Guardar</th>
  </tr>

  {% for m in mercado %}
  <tr>
    <td><b>{{ m.cereal }}</b></td>

    <td>
      <input type="number" id="p_{{ m.cereal }}" value="{{ m.pizarra }}">
    </td>

    <td>
      <input type="number" id="d_{{ m.cereal }}" value="{{ m.dolar }}">
    </td>

    <td>{{ m.fecha }}</td>

    <td>
      <button onclick="guardar('{{ m.cereal }}')">üíæ</button>
    </td>
  </tr>
  {% endfor %}
</table>

</div>

<script>
function guardar(cereal){
  fetch("/api/mercado",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      cereal: cereal,
      pizarra: document.getElementById("p_"+cereal).value,
      dolar: document.getElementById("d_"+cereal).value
    })
  }).then(()=>{
    alert("Precio actualizado");
    location.reload();
  });
}
</script>

</body>
</html>
